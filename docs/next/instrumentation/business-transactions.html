<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Business Transactions · inspectIT Ocelot Documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Collected metrics and traces are often related to business transactions. "/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Business Transactions · inspectIT Ocelot Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://inspectit.github.io/inspectit-ocelot/"/><meta property="og:description" content="Collected metrics and traces are often related to business transactions. "/><meta property="og:image" content="https://inspectit.github.io/inspectit-ocelot/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://inspectit.github.io/inspectit-ocelot/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/inspectit-ocelot/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/inspectit-ocelot/js/scrollSpy.js"></script><link rel="stylesheet" href="/inspectit-ocelot/css/main.css"/><script src="/inspectit-ocelot/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/inspectit-ocelot/"><img class="logo" src="/inspectit-ocelot/img/ocelot_head_sil_logo.svg" alt="inspectIT Ocelot Documentation"/><h2 class="headerTitleWithLogo">inspectIT Ocelot Documentation</h2></a><a href="/inspectit-ocelot/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://inspectit.rocks/" target="_self">inspectIT Ocelot Website</a></li><li class=""><a href="https://github.com/inspectIT/inspectit-ocelot" target="_self">GitHub Repository</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Instrumentation</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Getting Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/doc1">Hello World</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/getting-started/quick-start">Quick Start</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/getting-started/docker-examples">Demo Application</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/getting-started/installation">Installation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Configuration<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/configuration/configuration-sources">Configuration Sources</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/configuration/external-configuration-sources">External Configuration Sources</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/configuration/logging-configuration">Logging Configuration</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/configuration/start-configuration">Start Configuration</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/configuration/opentelemetry-configuration">OpenTelemetry Configuration</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/configuration/plugin-configuration">Plugin Configuration</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/configuration/agent-command-configuration">Agent Command Configuration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Metrics<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/metrics/metrics">Metrics</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/metrics/metric-recorders">Metrics Recorders</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/metrics/metric-exporters">Metrics Exporters</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/metrics/common-tags">Common Tags</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/metrics/custom-metrics">Custom Metrics</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/metrics/self-monitoring">Self-Monitoring</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/metrics/tag-guard">Tag-Guard</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Tracing<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/tracing/tracing">Tracing</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/tracing/trace-exporters">Trace Exporters</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/tracing/log-correlation">Log Correlation</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/tracing/privacy">Data Privacy</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/tracing/tracing-self-monitoring">Self-Monitoring</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Instrumentation<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/instrumentation">Instrumentation</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/scopes">Scopes</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/actions">Actions</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/rules">Rules</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/data-propagation">Data Propagation</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/metrics">Collecting Metrics</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/tracing">Collecting Tracing</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/business-transactions">Business Transactions</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/code-style">Configuration Code Style</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/special-sensors">Special Sensors</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/instrumentation/process">Instrumentation Process</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Default Instrumentation<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/default-instrumentation/default-instrumentation">Default Instrumentation</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/default-instrumentation/jakarta">Upgrade to Jakarta Namespace</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/default-instrumentation/apache-client5">Upgrade to Apache Client 5</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">End User Monitoring<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/enduser-monitoring/enduser-monitoring-server">Overview</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/enduser-monitoring/eum-server-setup">Server Setup</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/enduser-monitoring/eum-server-configuration">Server, Metrics and Exporter Configuration</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/enduser-monitoring/install-eum-agent">Install EUM Agent</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Configuration Server<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/cs-configuration">Server Configuration</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/managing-files">Managing Files</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/files-staging">File Staging</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/agent-mappings">Agent Mappings</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/scope-wizard">Scope Wizard</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/class-browser">Class Browser</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/user-authentication">User Authentication</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/config-docs">Configuration Docs</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/log-config">Server Logging Configuration</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/yaml-editor">YAML Editor</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/status-table-view">Agent Status Table View</a></li><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/config-server/alerting">Alerting</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Breaking Changes<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/inspectit-ocelot/docs/next/breaking-changes/Breaking Changes">Breaking Changes</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/inspectIT/inspectit-ocelot/edit/master/inspectit-ocelot-documentation/docs/instrumentation/business-transactions.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Business Transactions</h1></header><article><div><span><p>Collected metrics and traces are often related to business transactions.
For example some database calls might be related to a login process, or some HTTP endpoints are part of
a specific selling order.
inspectIT Ocelot allows you to link such business transactions with the corresponding data.</p>

    <div class="admonition admonition-note">
      <div class="admonition-heading">
        <h5><div class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></div> note</h5>
      </div>
      <div class="admonition-content">
    <p>This chapter assumes you are already familiar with instrumentation.</p>
<p>Please make sure to read the previous chapters about <a href="/inspectit-ocelot/docs/next/instrumentation/scopes">scopes</a>, <a href="/inspectit-ocelot/docs/next/instrumentation/actions">actions</a> &amp; <a href="/inspectit-ocelot/docs/next/instrumentation/rules">rules</a>.</p>
</div></div><h2><a class="anchor" aria-hidden="true" id="detecting-business-transactions"></a><a href="#detecting-business-transactions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Detecting Business Transactions</h2>
<p>First of all, it is necessary to detect which business transaction currently occurs.
There are <strong>no strict rules</strong> on how to detect transactions. Most likely it will depend on your specific case.
For example, you can derive transactions from Java objects with actions or via scopes themselves.
Another option is to analyze HTTP paths and derive the business transaction from them.
Because of the <a href="/inspectit-ocelot/docs/next/instrumentation/rules#modularizing-rules">modularity of rules</a>,
you are able to create template rules to detect business transaction and reuse them in other rules.</p>
<p>Below there are some examples on how to detect business transactions in the context of a web shop.
The detected business transaction will be written into the variable <code>business_transaction</code>, which later may be used
in metrics or traces.</p>
<h3><a class="anchor" aria-hidden="true" id="detecting-business-transactions-via-http-path"></a><a href="#detecting-business-transactions-via-http-path" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Detecting Business Transactions via HTTP Path</h3>
<p>This example uses the HTTP paths of incoming requests to our service to derive the business transaction from it.
Let's assume our service uses the Javax HTTP Servlet.
We use two actions from the inspectIT Ocelot <a href="/inspectit-ocelot/docs/next/default-instrumentation/default-instrumentation">default instrumentation</a>
to read the HTTP path and determine the business transaction via regex pattern. There are many more default actions available.
The rule acts as a template and can be included in other rules.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">inspectit:</span>
  <span class="hljs-attr">instrumentation:</span>
    <span class="hljs-attr">rules:</span>
      <span class="hljs-attr">r_detect_business_transaction_via_http:</span>
        <span class="hljs-attr">entry:</span>
          <span class="hljs-comment"># read the HTTP path from the request in the method arguments</span>
          <span class="hljs-attr">http_path:</span>
            <span class="hljs-attr">action:</span> <span class="hljs-string">a_httpservletrequest_getPath</span>
            <span class="hljs-attr">data-input:</span>
                <span class="hljs-attr">request:</span> <span class="hljs-string">_arg0</span>
          <span class="hljs-comment"># determine the business transaction via HTTP path</span>
          <span class="hljs-comment"># e.g. the path '/api/v1/order/discount/5' will result in the transaction 'discount-order'</span>
          <span class="hljs-attr">business_transaction:</span>
            <span class="hljs-attr">action:</span> <span class="hljs-string">a_regex_extractMatch</span>
            <span class="hljs-attr">data-input:</span>
              <span class="hljs-attr">string:</span> <span class="hljs-string">http_path</span>
            <span class="hljs-attr">constant-input:</span>
              <span class="hljs-attr">pattern:</span> <span class="hljs-string">"^\/api\/v1\/([^\/]+)\/([^\/]+)(?:\/.*)?$"</span>
              <span class="hljs-attr">result:</span> <span class="hljs-string">"$2-$1"</span>
              
      <span class="hljs-comment"># use the template in other rules</span>
      <span class="hljs-attr">r_other_rule:</span>
        <span class="hljs-attr">include:</span>
          <span class="hljs-attr">r_detect_business_transaction_via_http:</span> <span class="hljs-literal">true</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="detecting-business-transactions-via-actions"></a><a href="#detecting-business-transactions-via-actions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Detecting Business Transactions via Actions</h3>
<p>This example uses specific Java objects to detect the business transaction.
In this case, we examine an <code>Order</code> object to get the type of order via action.
The order type will be used as business transaction. The rule acts as a template and can be included in other rules.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">inspectit:</span>
  <span class="hljs-attr">instrumentation:</span>
    <span class="hljs-attr">actions:</span>
      <span class="hljs-comment"># read information from specific Java objects</span>
      <span class="hljs-attr">a_read_order_type:</span>
        <span class="hljs-attr">input:</span>
          <span class="hljs-attr">order:</span> <span class="hljs-string">'com.example.order.Order'</span>
        <span class="hljs-attr">value:</span> <span class="hljs-string">order.getType().getName()</span>

    <span class="hljs-attr">rules:</span>
      <span class="hljs-attr">r_detect_business_transaction_via_object:</span>
        <span class="hljs-attr">entry:</span>
          <span class="hljs-comment"># read the business transaction from order object in the method arguments</span>
          <span class="hljs-attr">business_transaction:</span>
            <span class="hljs-attr">action:</span> <span class="hljs-string">a_read_order_type</span>
            <span class="hljs-attr">data-input:</span>
              <span class="hljs-attr">order:</span> <span class="hljs-string">_arg0</span>

      <span class="hljs-comment"># use the template in other rules</span>
      <span class="hljs-attr">r_other_rule:</span>
        <span class="hljs-attr">include:</span>
          <span class="hljs-attr">r_detect_business_transaction_via_object:</span> <span class="hljs-literal">true</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="detecting-business-transactions-via-scopes"></a><a href="#detecting-business-transactions-via-scopes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Detecting Business Transactions via Scopes</h3>
<p>This example uses the methods of a Java class to determine the business transaction.
The class supports three types of orders: discount, regular and business.
Since the business transaction depends on a specific class, we probably cannot use the rule as a template.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">inspectit:</span>
  <span class="hljs-attr">instrumentation:</span>
    <span class="hljs-attr">scopes:</span>
      <span class="hljs-comment"># Java class to process incoming orders in different ways</span>
      <span class="hljs-attr">s_orderFilter:</span>
        <span class="hljs-attr">type:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">'com.example.filter.OrderFilter'</span>
        <span class="hljs-attr">methods:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">'discountOrder'</span>
          <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">'regularOrder'</span>
          <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">'businessOrder'</span>
            
    <span class="hljs-attr">rules:</span>
      <span class="hljs-attr">r_detect_business_transaction_via_scope:</span>
        <span class="hljs-attr">scopes:</span>
          <span class="hljs-attr">s_order_filter:</span> <span class="hljs-literal">true</span>
        <span class="hljs-attr">entry:</span>
          <span class="hljs-comment"># use the method name as business transaction</span>
          <span class="hljs-attr">business_transaction:</span>
            <span class="hljs-attr">action:</span> <span class="hljs-string">a_assign_value</span>
            <span class="hljs-attr">data-input:</span>
              <span class="hljs-attr">value:</span> <span class="hljs-string">_methodName</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="propagating-business-data"></a><a href="#propagating-business-data" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Propagating Business Data</h2>
<p>Normally, we would like to link one business transaction with multiple data. For instance, we want to include the
business transaction into attributes of multiple spans. Since we are not able to detect the business transaction
at every location we want to create spans, we instead detect the business transaction once and propagate it to other
locations, where it can be used for attributes or tags.</p>
<p>To enable propagation for your business data, you have to configure the propagation for specific data tags once globally.
For instance, we would like to reuse the previously mentioned tag <code>business_transaction</code>.</p>
<p>In short, <strong>down propagation</strong> will allow you to use the tag in every rule after the rule, which detected the business transaction.
<strong>Up propagation</strong> will make the tag available in previous rules as well.
This will be useful, if you cannot detect the business transaction at the entrypoint of your service where for instance
the root span is created.
If the business transaction was detected later, because of up propagation you will be able to use it as an attribute
in the span of the entrypoint, even tough the data was only available after that.</p>
<p>For more detailed information, view the section <a href="/inspectit-ocelot/docs/next/instrumentation/data-propagation">Data propagation</a>.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">inspectit:</span>
  <span class="hljs-attr">instrumentation:</span>
    <span class="hljs-attr">data:</span>
      <span class="hljs-attr">business_transaction:</span> 
        <span class="hljs-attr">down-propagation:</span> <span class="hljs-string">"GLOBAL"</span>
        <span class="hljs-attr">up-propagation:</span> <span class="hljs-string">"JVM_LOCAL"</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="extending-metrics"></a><a href="#extending-metrics" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extending Metrics</h2>
<p>After detecting the business transaction you are able to include it into your metrics.
Again, because of the <a href="/inspectit-ocelot/docs/next/instrumentation/rules#modularizing-rules">modularity of rules</a> you can create a template
rule to write business data into metrics. When using propagation, you don't have to include the rule for detecting the
business transaction in every other rule. Additionally, you should add your business tags to your metric definitions.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">inspectit:</span>
  <span class="hljs-attr">metrics:</span>
    <span class="hljs-attr">definitions:</span>
      <span class="hljs-string">'[method/duration]'</span><span class="hljs-string">:</span>
        <span class="hljs-attr">unit:</span> <span class="hljs-string">ms</span>
        <span class="hljs-attr">description:</span> <span class="hljs-string">'the duration from method entry to method exit'</span>
        <span class="hljs-attr">views:</span>
          <span class="hljs-string">'[method/duration/sum]'</span><span class="hljs-string">:</span>
            <span class="hljs-attr">aggregation:</span> <span class="hljs-string">SUM</span>
            <span class="hljs-attr">tags:</span>
              <span class="hljs-attr">'method_name':</span> <span class="hljs-literal">true</span>
              <span class="hljs-attr">'business_transaction':</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># business tag</span>
          <span class="hljs-string">'[method/duration/count]'</span><span class="hljs-string">:</span>
            <span class="hljs-attr">aggregation:</span> <span class="hljs-string">COUNT</span>
            <span class="hljs-attr">tags:</span>
              <span class="hljs-attr">'method_name':</span> <span class="hljs-literal">true</span>
              <span class="hljs-attr">'business_transaction':</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># business tag</span>
</code></pre>
<p>After defining your metric you can create a rule, which uses the detected business transaction as tag.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">inspectit:</span>
  <span class="hljs-attr">instrumentation:</span>
    <span class="hljs-attr">rules:</span>
      <span class="hljs-attr">r_metrics_business_transaction:</span>
        <span class="hljs-comment"># include rule to detect business transaction</span>
        <span class="hljs-attr">include:</span>
          <span class="hljs-attr">r_detect_business_transaction:</span> <span class="hljs-literal">true</span>
        <span class="hljs-attr">metrics:</span>
          <span class="hljs-string">'[method/duration]'</span><span class="hljs-string">:</span>
            <span class="hljs-comment"># use business transaction as tag</span>
            <span class="hljs-attr">data-tags:</span>
              <span class="hljs-attr">business_transaction:</span> <span class="hljs-string">business_transaction</span>

      <span class="hljs-comment"># use the template in other rules</span>
      <span class="hljs-attr">r_other_rule:</span>
        <span class="hljs-attr">include:</span>
          <span class="hljs-attr">r_metrics_business_transaction:</span> <span class="hljs-literal">true</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="extending-traces"></a><a href="#extending-traces" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extending Traces</h2>
<p>Furthermore, after detecting the business transaction you are also able to include it into your traces.
Again, because of the <a href="/inspectit-ocelot/docs/next/instrumentation/rules#modularizing-rules">modularity of rules</a> you can create a template
rule to write business data into traces. When using propagation, you don't have to include the rule for detecting the
business transaction in every other rule. The principle is similar to metrics.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">inspectit:</span>
  <span class="hljs-attr">instrumentation:</span>
    <span class="hljs-attr">rules:</span>
      <span class="hljs-attr">r_tracing_business_transaction:</span>
        <span class="hljs-comment"># include rule to detect business transaction</span>
        <span class="hljs-attr">include:</span>
          <span class="hljs-attr">r_detect_business_transaction:</span> <span class="hljs-literal">true</span>
        <span class="hljs-attr">tracing:</span>
          <span class="hljs-attr">attributes:</span>
            <span class="hljs-attr">business_transaction:</span> <span class="hljs-string">business_transaction</span>

      <span class="hljs-comment"># use the template in other rules</span>
      <span class="hljs-attr">r_other_rule:</span>
        <span class="hljs-attr">include:</span>
          <span class="hljs-attr">r_tracing_business_transaction:</span> <span class="hljs-literal">true</span>
</code></pre>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 8/28/2025 by EddeCCC</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/inspectit-ocelot/docs/next/instrumentation/tracing"><span class="arrow-prev">← </span><span>Collecting Tracing</span></a><a class="docs-next button" href="/inspectit-ocelot/docs/next/instrumentation/code-style"><span>Configuration Code Style</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#detecting-business-transactions">Detecting Business Transactions</a><ul class="toc-headings"><li><a href="#detecting-business-transactions-via-http-path">Detecting Business Transactions via HTTP Path</a></li><li><a href="#detecting-business-transactions-via-actions">Detecting Business Transactions via Actions</a></li><li><a href="#detecting-business-transactions-via-scopes">Detecting Business Transactions via Scopes</a></li></ul></li><li><a href="#propagating-business-data">Propagating Business Data</a></li><li><a href="#extending-metrics">Extending Metrics</a></li><li><a href="#extending-traces">Extending Traces</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2025 Novatec Consulting GmbH</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                appId: 'P7JV0ZK66K',
                apiKey: 'd499024131bf8d92e6d469a6c14f4798',
                indexName: 'inspectit-ocelot',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["version:next"]}
              });
            </script></body></html>